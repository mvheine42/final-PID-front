<div class="asign-inactive-order-container p-card">
  <div class="content-container">
    <!-- Columna izquierda: lista de reservas del día -->
    <div class="orders-list">
      <div class="search-box">
        <i class="pi pi-search search-icon"></i>
        <input
          type="text"
          pInputText
          placeholder="Search by name or time"
          [(ngModel)]="searchText"
        />
      </div>

      <p-table
        [value]="filteredReservations"
        selectionMode="single"
        [(selection)]="selectedReservation"
        dataKey="id"
        scrollable="true"
        scrollHeight="200px"
      >
        <ng-template pTemplate="header">
          <tr>
            <th>Time</th>
            <th>Name</th>
            <th class="people-column">People</th>
            <th>Mesa</th>
          </tr>
        </ng-template>

        <ng-template pTemplate="body" let-r>
          <tr (click)="selectReservation(r)" [class.selected]="r === selectedReservation">
            <td>{{ r.reservationTime }}</td>
            <td>{{ r.customerName }}</td>
            <td class="people-column">{{ r.amountOfPeople }} <i class="pi pi-users"></i></td>
            <td>{{ r.table_id || '-' }}</td>
          </tr>
        </ng-template>
      </p-table>
    </div>

    <!-- Columna derecha: detalle + asignación -->
    <div class="order-details" *ngIf="selectedReservation">
      <h4 class="selected-order-title">
        Selected Reservation: {{ selectedReservation.customerName }}
      </h4>

      <p class="muted">
        {{ selectedReservation.reservationDate }} ·
        {{ selectedReservation.reservationTime }} ·
        {{ selectedReservation.amountOfPeople }} people
      </p>

      <p-dropdown
        [options]="availableTables"
        [(ngModel)]="selectedTable"
        appendTo="body"
        optionLabel="label"
        optionValue="id"
        placeholder="Select Table"
        [style]="{'width': '100%'}"
        [filter]="true"
        [filterPlaceholder]="'Asign table...'"
        [showClear]="true"
      >
      </p-dropdown>

      <div class="button-container">
        <button pButton label="Close" (click)="close.emit()" class="p-button-secondary"></button>
        <button pButton label="Asign table" (click)="showConfirmPopUp()" class="p-button-success"
                [disabled]="!selectedReservation || !selectedTable"></button>
      </div>
    </div>
  </div>
</div>

<!-- Confirmación -->
<p-dialog [(visible)]="confirmationDialog" class="custom-modal" [modal]="true">
  <ng-template pTemplate="header">
    <i class="pi pi-exclamation-triangle" style="color: red; font-size: 1.5rem;"></i>
    <h2>Confirm</h2>
  </ng-template>
  <app-confirmation-pop-up
    (onSend)="assignTable()"
    (onClose)="closeConfirmationPopUp()"
    [subtitle]="'The table will be reserved for this booking'">
  </app-confirmation-pop-up>
</p-dialog>

<!-- Loading overlay -->
<div *ngIf="isLoading" class="overlay">
  <p-progressSpinner styleClass="custom-spinner" [animationDuration]="'0.5'"></p-progressSpinner>
</div>

